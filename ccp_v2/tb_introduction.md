# TensorBoard Introduction

![TensorBoard logo](../images/tb_logo.png)

[TensorBoard](https://www.tensorflow.org/tensorboard) is a powerful visualization tool designed to provide insights into machine learning models as they are being developed and trained. Originally developed as part of the TensorFlow ecosystem, TensorBoard has since evolved into a versatile tool that can be used with various machine learning frameworks beyond TensorFlow, making it an essential part of the modern machine learning workflow. It helps data scientists, researchers and engineers to visualize and debug models, monitor metric, and gain a deeper understanding of model performance, all within an intuitive, web-based interface.
It provides real-time feedback during model training and allows you to explore various aspects of your model, including:

- **Scalars**: Track key metrics like loss, accuracy, learning rate and other scalar values over time.
- **Histograms**: Visualize the distribution of weights, biases and activations across your network layers.
- **Graphs**: Inspect the computational graph of your model to understand its architecture and identify potential bottlenecks.
- **Images**: Display images used during training, or generated by the model (e.g., reconstructions in autoencoders).
- **Text**: Visualize text data, such as summaries or generated sequences.
- **Embeddings**: Explore high-dimensional data (e.g., word embeddings) in a lower-dimensional space using techniques like PCA or t-SNE.
- **Hyperparameters**: Monitor how different hyperparameters affect your model's performance.

TensorBoard is particularly useful for comparing different models or experiments side by side, helping you make informed decisions about hyperparameter tuning and model optimization.

TensorBoard operates by reading event files that are generated by your machine learning framework during training. These event files contain logs of various metrics, summaries and other data that TensorBoard can visualize. Typically, these logs are created by instrumenting your training script with calls to logging functions, which write the necessary data to the event files.

## Installing TensorBoard

Before using TensorBoard, you'll need to install it. TensorBoard is bundled with TensorFlow, so if you have TensorFlow installed, you likely already have TensorBoard. However, you can also install it separately using pip:

```bash
pip install tensorboard
```

## Integrating TensorBoard with your training script

To use TensorBoard, you need to log relevant data during model training. This is typically done by creating a `SummaryWriter` object, which writes data to log files that TensorBoard can later read.

### Example with TensorFlow/Keras

Here's how you can integrate TensorBoard into a TensorFlow/Keras training script:

```python
import tensorflow as tf
from tensorflow.keras.callbacks import TensorBoard

# Define a simple model
model = tf.keras.models.Sequential([
    tf.keras.layers.Dense(128, activation='relu', input_shape=(784,)),
    tf.keras.layers.Dense(64, activation='relu'),
    tf.keras.layers.Dense(10, activation='softmax')
])

# Compile the model
model.compile(optimizer='adam',
              loss='sparse_categorical_crossentropy',
              metrics=['accuracy'])

# Initialize TensorBoard callback
tensorboard_callback = TensorBoard(log_dir="./logs")

# Train the model
model.fit(X_train, y_train, epochs=10, validation_data=(X_test, y_test), callbacks=[tensorboard_callback])
```

In this example:
- **`TensorBoard(log_dir="./logs")`**: The `log_dir` parameter specifies the directory where the log files will be saved. These logs can then be visualized using TensorBoard.

### Example with PyTorch

In PyTorch, you can log data using the `SummaryWriter` from the `torch.utils.tensorboard` module:

```python
import torch
import torch.nn as nn
import torch.optim as optim
from torch.utils.tensorboard import SummaryWriter

# Define a simple model
class SimpleModel(nn.Module):
    def __init__(self):
        super(SimpleModel, self).__init__()
        self.fc1 = nn.Linear(784, 128)
        self.fc2 = nn.Linear(128, 64)
        self.fc3 = nn.Linear(64, 10)

    def forward(self, x):
        x = torch.relu(self.fc1(x))
        x = torch.relu(self.fc2(x))
        x = torch.softmax(self.fc3(x), dim=1)
        return x

# Initialize model, loss function, optimizer, and TensorBoard writer
model = SimpleModel()
criterion = nn.CrossEntropyLoss()
optimizer = optim.Adam(model.parameters(), lr=0.001)
writer = SummaryWriter(log_dir="./logs")

# Training loop
for epoch in range(10):
    for batch in train_loader:
        X_batch, y_batch = batch
        optimizer.zero_grad()
        outputs = model(X_batch)
        loss = criterion(outputs, y_batch)
        loss.backward()
        optimizer.step()
    
    # Log the loss
    writer.add_scalar('Loss/train', loss.item(), epoch)

# Close the writer
writer.close()
```

In this example:
- **`SummaryWriter(log_dir="./logs")`**: Creates a writer object that logs data to the specified directory.

## Launching TensorBoard

Once your model is logging data, you can launch TensorBoard to visualize the results. Run the following command in your terminal:

```bash
tensorboard --logdir=./logs
```

- **`--logdir`**: Specifies the directory where the log files are stored.
- **`localhost:6006`**: By default, TensorBoard runs on port 6006. You can open this in your web browser to access the TensorBoard interface.

## Navigating the TensorBoard interface

When you open TensorBoard in your web browser, you'll see several tabs that correspond to different types of visualizations:

- **Scalars**: View graphs of scalar metrics, such as loss and accuracy, over time.
- **Graphs**: Visualize the computation graph of your model, helping you understand its structure and data flow.
- **Distributions and histograms**: Examine the distribution of tensors (e.g., weights, biases) and how they change during training.
- **Images**: View images logged during training, which is useful for visualizing model outputs like generated images or activation maps.
- **Text**: Display text data, such as generated sentences in an NLP model.
- **Embeddings**: Explore high-dimensional data using techniques like t-SNE or PCA, which are particularly useful for visualizing word embeddings or feature vectors.

## Advanced features

TensorBoard offers several advanced features that can further enhance your machine learning workflow:

- **Hyperparameter tuning**: Use TensorBoard to track and compare different hyperparameter configurations across multiple training runs.
- **Custom scalars**: Log and visualize custom scalar metrics that are specific to your model or experiment.
- **Projector**: The Embedding Projector tool in TensorBoard allows you to interactively explore embeddings, making it easier to understand relationships in high-dimensional data.
- **Profiler**: TensorBoard includes a profiling tool that helps identify performance bottlenecks in your model, such as inefficient operations or hardware usage issues.

## Using TensorBoard in non-TensorFlow environments

Although TensorBoard was initially designed for TensorFlow, it has grown to support other frameworks as well. PyTorch, for instance, has native support for TensorBoard logging, and with the appropriate logging calls, TensorBoard can also be used with other libraries like MXNet, Keras (standalone), and more. The key is to write logs in a format that TensorBoard can read.